"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_createClass=function(){function i(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,a){return e&&i(t.prototype,e),a&&i(t,a),t}}();function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var BoardComponent=function(t){function o(t){_classCallCheck(this,o);var a=_possibleConstructorReturn(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t));a.onDragEnd=function(t){var e=[].concat(_toConsumableArray(a.state.lists));t.source.droppableId===t.destination.droppableId?t.source.index<t.destination.index?(e[t.source.droppableId].cards=a.swapArray(e[t.source.droppableId].cards,t.source.index,t.destination.index),a.setState({lists:e})):t.source.index>t.destination.index&&(e[t.source.droppableId].cards=a.swapArray2(e[t.source.droppableId].cards,t.source.index,t.destination.index),a.setState({lists:e})):(e[t.destination.droppableId].cards.splice(t.destination.index,0,e[t.source.droppableId].cards[t.source.index]),e[t.source.droppableId].cards.splice(t.source.index,1),a.setState({lists:e}))},a.state={boardtitle:"Editable board title",tempboardtitle:"Editable board title",showboardtitleeditor:!1,lists:[{id:"L0",title:"Stuff to try (this is a list)",cards:[{id:"C0",title:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",displayaction:!1},{id:"C1",title:"B",displayaction:!1}]},{id:"L1",title:"Another Listttttttttttttttttttttttttttttttttttttttttttttttttttt",cards:[{id:"C2",title:"X",displayaction:!1},{id:"C3",title:"Y",displayaction:!1},{id:"C4",title:"Z",displayaction:!1}]}],input:"",show:!1,cardshows:[],displays:[],actionlistdisplays:[],actioncarddisplays:[],titleinput:"",cardinput:""},a.temptext="",a.listId=2,a.cardsId=5;var e=a.cardsId;a.clickOutsideTarget=a.clickOutsideTarget.bind(a),a.changeBoardTitle=a.changeBoardTitle.bind(a),a.showBoardTitleEditor=a.showBoardTitleEditor.bind(a),a.cardList=a.cardList.bind(a),a.listOfList=a.listOfList.bind(a),a.addList=a.addList.bind(a),a.displayForm=a.displayForm.bind(a),a.handleChange=a.handleChange.bind(a),a.handleTitleChange=a.handleTitleChange.bind(a),a.hideTitleEditor=a.hideTitleEditor.bind(a),a.ListComonpent=a.ListComonpent.bind(a),a.handleCardChange=a.handleCardChange.bind(a),a.hideCardMenu=a.displayCardMenu.bind(a),a.onDragEnd=a.onDragEnd.bind(a),a.edits=[],a.shows=[],a.addcards=[],a.copycards=[],a.deletecards=[],a.displayCardMenus=[],a.displayActionLists=[],a.listDisplayActionCards=[],a.deletelists=[],a.copylists=[];for(var i=a.state.lists.length,s=0;s<e;s++)a.listDisplayActionCards.push(a.displayActionCard.bind(a,s));for(var n=0;n<i;n++){a.edits.push(a.changeListTitle.bind(a,n)),a.shows.push(a.showTitleEditor.bind(a,n)),a.displayCardMenus.push(a.displayCardMenu.bind(a,n)),a.displayActionLists.push(a.displayActionList.bind(a,n)),a.addcards.push(a.addcard.bind(a,n)),a.deletelists.push(a.deleteList.bind(a,n)),a.copylists.push(a.copyList.bind(a,n));for(var d=a.state.lists[n].cards.length,l=[],r=[],c=0;c<d;c++)l.push(a.copyCard.bind(a,n,c)),r.push(a.deleteCard.bind(a,n,c));a.copycards.push(l),a.deletecards.push(r)}return a}return _inherits(o,React.Component),_createClass(o,[{key:"componentDidMount",value:function(){window.onClick=function(t){console.log("F")}}},{key:"clickOutsideTarget",value:function(){var e=this;window.onclick=function(t){!t.target.matches(".actionbutton")&&e.state.actionlistdisplays.includes(!0)&&e.setState({actionlistdisplays:e.falseCardShowsList(e.state.actionlistdisplays.length)}),!t.target.matches(".boardtitle")&&e.state.showboardtitleeditor&&(e.setState({showboardtitleeditor:!1}),""!==e.state.boardtitle.trim()?e.setState({tempboardtitle:e.state.boardtitle}):e.setState({boardtitle:e.state.tempboardtitle}))}}},{key:"falseCardShowsList",value:function(t){for(var e=[],a=0;a<t;a++)e[a]=!1;return e}},{key:"hideCardMenu",value:function(){this.setState({cardshows:this.falseCardShowsList(this.state.cardshows.length),cardinput:""})}},{key:"displayCardMenu",value:function(t){var e=this.falseCardShowsList(this.state.cardshows.length);e[t]=!0,this.setState({cardshows:e,cardinput:""}),window.setTimeout(function(){return document.getElementById("addcardid"+t).focus()},0)}},{key:"displayActionCard",value:function(t){this.setState({actioncarddisplays:this.makeListTrue(this.state.actioncarddisplays[t],t,this.state.actioncarddisplays)})}},{key:"makeListTrue",value:function(t,e,a){for(var i=[],s=0;s<a;s++)i[s]=!1;return t||(i[e]=!0),i}},{key:"displayActionList",value:function(t){this.setState({actionlistdisplays:this.makeListTrue(this.state.actionlistdisplays[t],t,this.state.actionlistdisplays.length)})}},{key:"ListComonpent",value:function(t){return React.createElement("div",null,t)}},{key:"cardList",value:function(){var s=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=arguments[1];if("object"!==(void 0===t?"undefined":_typeof(t))||"function"!=typeof t.map)return[];var e=t.map(function(e,a){var i=parseInt(e.id[1]);return React.createElement(ReactBeautifulDnd.Draggable,{key:e.id,draggableId:e.id,index:a},function(t){return React.createElement("div",Object.assign({},t.draggableProps,t.dragHandleProps,{ref:t.innerRef}),React.createElement("li",null,React.createElement("div",{className:"white cardtitle"},e.title+"("+e.id+")",React.createElement("div",null,React.createElement("button",{className:"actionbutton",onClick:s.listDisplayActionCards[i]},"..."),React.createElement("div",{className:"inline actionlist "+(s.state.actioncarddisplays[i]?"WPWWP":"hiddentextarea")},React.createElement("button",{className:"actionbutton",onClick:s.deletecards[n][a]},"Delete"),React.createElement("br",null),React.createElement("button",{className:"actionbutton",onClick:s.copycards[n][a]},"Copy"))))))})});return React.createElement("ul",null,e)}},{key:"addcard",value:function(t){if(event.preventDefault(),""!==this.state.cardinput.trim()){var e=[].concat(_toConsumableArray(this.state.lists));e[t].cards.push({id:"C"+this.cardsId,title:this.state.cardinput}),this.setState({id:e[t],cardinput:"",lists:e}),this.cardsId++,this.listDisplayActionCards.push(this.displayActionCard.bind(this,this.cardsId-1)),this.copycards[t].push(this.copyCard.bind(this,t,e[t].cards.length-1)),this.deletecards[t].push(this.deleteCard.bind(this,t,e[t].cards.length-1))}}},{key:"copyCard",value:function(t,e){var a=[].concat(_toConsumableArray(this.state.lists));a[t].cards.push({id:"C"+this.cardsId,title:a[t].cards[e].title,displayaction:a[t].cards[e].displayaction}),this.setState({lists:a}),this.cardsId++,this.listDisplayActionCards.push(this.displayActionCard.bind(this,this.cardsId-1)),this.copycards[t].push(this.copyCard.bind(this,t,a[t].cards.length-1)),this.deletecards[t].push(this.deleteCard.bind(this,t,a[t].cards.length-1))}},{key:"deleteCard",value:function(t,e){var a=[].concat(_toConsumableArray(this.state.lists));a[t].cards.splice(e,1),this.setState({lists:a})}},{key:"showTitleEditor",value:function(t){var e=[].concat(_toConsumableArray(this.state.displays)).map(function(t){return!1});e[t]=!0,this.setState({displays:e,titleinput:""}),window.setTimeout(function(){document.getElementById("titlechange"+t).focus()},0)}},{key:"hideTitleEditor",value:function(){this.setState({displays:[].concat(_toConsumableArray(this.state.displays)).map(function(t){return!1}),titleinput:""})}},{key:"handleTitleChange",value:function(t){this.setState({titleinput:t.target.value}),console.log(this.state.titleinput)}},{key:"handleCardChange",value:function(t){this.setState({cardinput:t.target.value})}},{key:"handleChange",value:function(t){this.setState({input:t.target.value})}},{key:"changeListTitle",value:function(t){if(event.preventDefault(),""!==this.state.titleinput.trim()){var e=[].concat(_toConsumableArray(this.state.lists)),a=[].concat(_toConsumableArray(this.state.displays)),i=[].concat(_toConsumableArray(e[t].cards));e[t]={id:e[t].id,title:this.state.titleinput,cards:i},a[t]=!1,this.setState({lists:e,displays:a})}}},{key:"displayForm",value:function(){this.setState(function(t){return{show:!t.show}}),window.setTimeout(function(){return document.getElementById("addlistid").focus()},0)}},{key:"swapArray2",value:function(t,e,a){return t.splice(a,0,t[e]),t.splice(e+1,1),t}},{key:"swapArray",value:function(t,e,a){return t.splice(a+1,0,t[e]),t.splice(e,1),t}},{key:"addList",value:function(){if(event.preventDefault(),""!==this.state.input.trim()){var t=[].concat(_toConsumableArray(this.state.lists));this.listId;t.push({id:"L"+this.listId,title:this.state.input,cards:[]}),this.setState({lists:t,input:""}),this.listId++,this.edits.push(this.changeListTitle.bind(this,t.length-1)),this.shows.push(this.showTitleEditor.bind(this,t.length-1)),this.displayCardMenus.push(this.displayCardMenu.bind(this,t.length-1)),this.addcards.push(this.addcard.bind(this,t.length-1)),this.deletelists.push(this.deleteList.bind(this,t.length-1)),this.displayActionLists.push(this.displayActionList.bind(this,t.length-1)),this.copycards.push([]),this.deletecards.push([])}}},{key:"deleteList",value:function(t){var e=[].concat(_toConsumableArray(this.state.lists));e.splice(t,1),this.setState({lists:e})}},{key:"copyList",value:function(t){var a=this,e=[].concat(_toConsumableArray(this.state.lists)),i=e[t].cards.map(function(t){var e={id:"C"+a.cardsId,title:t.title};return a.cardsId++,e}),s={id:"L"+this.listId,title:e[t].title,cards:i};e.push(s),this.setState({lists:e}),this.listId++,this.edits.push(this.changeListTitle.bind(this,e.length-1)),this.shows.push(this.showTitleEditor.bind(this,e.length-1)),this.displayCardMenus.push(this.displayCardMenu.bind(this,e.length-1)),this.addcards.push(this.addcard.bind(this,e.length-1)),this.deletelists.push(this.deleteList.bind(this,e.length-1)),this.copylists.push(this.copyList.bind(this,e.length-1)),this.displayActionLists.push(this.displayActionList.bind(this,e.length-1))}},{key:"listOfList",value:function(){var i=this;return this.state.lists.map(function(e,a){return React.createElement("div",{key:e.id,className:"divclass"},React.createElement("div",{className:"listtitle"},React.createElement("h6",{className:i.state.displays[a]?"hiddentextarea":"",onClick:i.shows[a]},e.title+"("+e.id+")"),React.createElement("form",{className:i.state.displays[a]?"":"hiddentextarea",onSubmit:i.edits[a]},React.createElement("input",{id:"titlechange"+a,onChange:i.handleTitleChange,value:i.state.titleinput,type:"text"}),React.createElement("input",{type:"submit",value:"Change"}),React.createElement("button",{onClick:i.hideTitleEditor},"X")),React.createElement("div",null,React.createElement("button",{className:"actionbutton",onClick:i.displayActionLists[a]},"..."),React.createElement("div",{className:"actionlist "+(i.state.actionlistdisplays[a]?"":"hiddentextarea")},React.createElement("button",{className:"actionbutton",onClick:i.deletelists[a]},"Delete"),React.createElement("br",null),React.createElement("button",{className:"actionbutton",onClick:i.copylists[a]},"Copy")))),React.createElement(ReactBeautifulDnd.Droppable,{key:e.id,droppableId:a.toString()},function(t){return React.createElement("div",Object.assign({className:"Container"},t.droppableProps,{ref:t.innerRef}),i.ListComonpent(i.cardList(e.cards,a)),t.placeholder)}),React.createElement("div",{className:i.state.cardshows[a]?"":"hiddentextarea"},React.createElement("form",{onSubmit:i.addcards[a]},React.createElement("textarea",{id:"addcardid"+a,className:"w-100",value:i.state.cardinput,onChange:i.handleCardChange,placeholder:"Enter a title for this card"}),React.createElement("br",null),"                            ",React.createElement("input",{type:"submit",value:"Add card"}),React.createElement("button",{onClick:i.hideCardMenu},"X"))),React.createElement("button",{onClick:i.displayCardMenus[a],className:i.state.cardshows[a]?"hiddentextarea":""},"Add another card"))})}},{key:"changeBoardTitle",value:function(){this.setState({boardtitle:event.target.value})}},{key:"showBoardTitleEditor",value:function(){this.setState({showboardtitleeditor:!0})}},{key:"render",value:function(){return this.clickOutsideTarget(),console.log("Render"),React.createElement(ReactBeautifulDnd.DragDropContext,{onDragEnd:this.onDragEnd},React.createElement("div",null,React.createElement("p",{onClick:this.showBoardTitleEditor,className:"whitetext "+(this.state.showboardtitleeditor?"hiddentextarea":"")},React.createElement("b",{className:"boardtitle"},this.state.tempboardtitle)),React.createElement("p",{className:"whitetext boardtitle "+(this.state.showboardtitleeditor?"":"hiddentextarea")},React.createElement("input",{className:"boardtitle",type:"text",onChange:this.changeBoardTitle,value:this.state.boardtitle})),this.listOfList(),React.createElement("div",{className:"divclass"},React.createElement("button",{className:this.state.show?"hiddentextarea":"",onClick:this.displayForm},"Add another List"),React.createElement("form",{id:"on0",className:"small "+(this.state.show?"":"hiddentextarea"),onSubmit:this.addList},React.createElement("p",null,React.createElement("input",{id:"addlistid",onChange:this.handleChange,value:this.state.input,type:"text"})),React.createElement("p",null,React.createElement("input",{type:"submit",value:"Add list"}),React.createElement("button",{onClick:this.displayForm},"X"))))))}}]),o}();ReactDOM.render(React.createElement(BoardComponent,null),document.getElementById("board"));
