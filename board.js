"use strict";var _createClass=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}();function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,s=Array(t.length);e<t.length;e++)s[e]=t[e];return s}return Array.from(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var temps=function(){var t={boardtitle:"Editable board title",lists:[{id:"L0",title:"Stuff to try (this is a list)",cards:[{id:"C0",title:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},{id:"C1",title:"Familiarize yourself with git + github"}]},{id:"L1",title:"Another Listttttttttttttttttttttttttttttttttttttttttttttttttttt",cards:[{id:"C3",title:"X"},{id:"C4",title:"Y"},{id:"C5",title:"Z"}]},{id:"L2",title:"Bonus Considerations",cards:[{id:"C6",title:"Test Units"},{id:"C7",title:"Make it mobile responsive"},{id:"C8",title:"Create a bookself for the users that stores bookmarked books"},{id:"C9",title:"On search input, display the last 10 search queries."}]}],ids:{listsId:3,cardsId:10}};return{getTitle:function(){return t.boardtitle},get:function(){return t},changeTitle:function(e){t.boardtitle=e},getById:function(e){return t.lists.find(function(t){return t.id===e})},addCardId:function(){t.ids.cardsId++},addListId:function(){t.ids.listsId++},test:function(){t.lists[1].cards.push([])}}}(),ListsComponent=function(t){function e(t){_classCallCheck(this,e);var s=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));s.state={lists:temps.get().lists,showActionList:[],showTitleEditor:!1,showAddList:!1,newListTitle:""},s.toggleAddList=s.toggleAddList.bind(s),s.handleListTitleChange=s.handleListTitleChange.bind(s),s.addList=s.addList.bind(s),s.copyLists=[],s.deleteLists=[],s.showListActions=[];var i=s.state.lists.length;s.onDragEnd=s.onDragEnd.bind(s);for(var a=0;a<i;a++)s.copyLists.push(s.copyList.bind(s,a)),s.deleteLists.push(s.deleteList.bind(s,a)),s.showListActions.push(s.showListAction.bind(s,a));return s}return _inherits(e,React.Component),_createClass(e,[{key:"toggleAddList",value:function(){this.setState({showAddList:!this.state.showAddList})}},{key:"handleListTitleChange",value:function(){this.setState({newListTitle:event.target.value})}},{key:"onDragEnd",value:function(t){if(t.destination){if("column"===t.type){var e=Object.assign({},temps.get().lists[t.source.index]);return temps.get().lists.splice(t.source.index,1),temps.get().lists.splice(t.destination.index,0,e),void this.setState({lists:temps.get().lists})}if("task"===t.type){if(t.source.droppableId===t.destination.droppableId){var s=Object.assign({},temps.getById(t.source.droppableId).cards[t.source.index]);return temps.getById(t.source.droppableId).cards.splice(t.source.index,1),temps.getById(t.source.droppableId).cards.splice(t.destination.index,0,s),void this.setState({lists:temps.get().lists})}var i=Object.assign({},temps.getById(t.source.droppableId).cards[t.source.index]);return temps.getById(t.source.droppableId).cards.splice(t.source.index,1),temps.getById(t.destination.droppableId).cards.splice(t.destination.index,0,i),void this.setState({lists:temps.get().lists})}}}},{key:"showListAction",value:function(t){var e=[].concat(_toConsumableArray(this.state.showActionList));e[t]?e[t]=!e[t]:(e=[])[t]=!e[t],this.setState({showActionList:e})}},{key:"addList",value:function(){temps.get().lists.push({id:"L"+temps.get().ids.listsId,title:this.state.newListTitle,cards:[]}),temps.addListId(),this.setState({lists:temps.get().lists,newListTitle:""});var t=this.state.lists.length;this.copyLists.push(this.copyList.bind(this,t-1)),this.deleteLists.push(this.deleteList.bind(this,t-1)),this.showListActions.push(this.showListAction.bind(this,t-1))}},{key:"copyList",value:function(t){temps.get().lists.push({id:"L"+temps.get().ids.listsId,title:temps.get().lists[t].title,cards:[].concat(_toConsumableArray(temps.get().lists[t].cards.map(function(t){return{id:"C"+temps.get().ids.cardsId++,title:t.title}})))}),temps.addListId(),this.setState({lists:temps.get().lists,showActionList:[]});var e=this.state.lists.length;this.copyLists.push(this.copyList.bind(this,e-1)),this.deleteLists.push(this.deleteList.bind(this,e-1)),this.showListActions.push(this.showListAction.bind(this,e-1))}},{key:"deleteList",value:function(t){temps.get().lists.splice(t,1),this.setState({lists:temps.get().lists,showActionList:[]})}},{key:"render",value:function(){var t=this,e=this.state.lists.map(function(e,s){return React.createElement(ReactBeautifulDnd.Draggable,{key:e.id+"dropper",draggableId:e.id,index:s},function(i){return React.createElement("div",Object.assign({className:"inlinetable"},i.draggableProps,{ref:i.innerRef}),React.createElement("div",{key:e.id,className:"divclass "},React.createElement("div",Object.assign({},i.dragHandleProps,{className:"listtitle"}),React.createElement(ListTitleComponent,{id:e.id}),React.createElement("div",null,React.createElement("button",{className:"btn btn-sm actionbutton",onClick:t.showListActions[s]},"..."),React.createElement("div",{className:"actionlist "+(t.state.showActionList[s]?"":"hiddentextarea")},React.createElement("button",{className:"btn actionbutton",onClick:t.deleteLists[s]},"Delete"),React.createElement("br",null),React.createElement("button",{className:"btn actionbutton",onClick:t.copyLists[s]},"Copy")))),React.createElement(CardsComponent,{id:e.id})))})});return React.createElement(ReactBeautifulDnd.DragDropContext,{onDragEnd:this.onDragEnd},React.createElement(ReactBeautifulDnd.Droppable,{droppableId:"all-col",direction:"horizontal",type:"column"},function(s){return React.createElement("div",Object.assign({className:"inlinetable"},s.droppableProps,{ref:s.innerRef}),React.createElement("div",{className:"inlinetable"},e,{...s.placeholder},React.createElement("div",{className:"divclass"},React.createElement("button",{className:"btn btn-sm btn-light "+(t.state.showAddList?"hiddentextarea":""),onClick:t.toggleAddList},"Add another List"),React.createElement("div",{className:t.state.showAddList?"":"hiddentextarea "},React.createElement("textarea",{className:"w-100",placeholder:"Enter list title...",onChange:t.handleListTitleChange,value:t.state.newListTitle}),React.createElement("div",null,React.createElement("button",{className:"btn btn-sm btn-success",onClick:t.addList},"Add card"),React.createElement("button",{className:"btn btn-sm btn-dark",onClick:t.toggleAddList},"x"))))))}))}}]),e}(),ListTitleComponent=function(t){function e(t){_classCallCheck(this,e);var s=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return s.state={input:"",listTitle:temps.getById(s.props.id).title,tempListTitle:temps.getById(s.props.id).title,showListTitleEditor:!1},s.handleTitleChange=s.handleTitleChange.bind(s),s.showTitleEditor=s.showTitleEditor.bind(s),s.handleTitleSubmit=s.handleTitleSubmit.bind(s),s}return _inherits(e,React.Component),_createClass(e,[{key:"getById",value:function(t,e){return t.find(function(t){return t.id===e})}},{key:"handleTitleChange",value:function(){this.setState({tempListTitle:event.target.value})}},{key:"showTitleEditor",value:function(){this.setState({showListTitleEditor:!this.state.showListTitleEditor})}},{key:"handleTitleSubmit",value:function(){event.preventDefault(),""!==this.state.tempListTitle.trim()&&(this.getById(temps.get().lists,this.props.id).title=this.state.tempListTitle,this.setState({tempListTitle:this.getById(temps.get().lists,this.props.id).title,showListTitleEditor:!1}))}},{key:"render",value:function(){return React.createElement("div",null,React.createElement("p",{className:this.state.showListTitleEditor?"hiddentextarea":"",onClick:this.showTitleEditor},React.createElement("b",null,this.state.tempListTitle+" ("+temps.getById(this.props.id).id+")")),React.createElement("form",{className:this.state.showListTitleEditor?"":"hiddentextarea",onSubmit:this.handleTitleSubmit},React.createElement("input",{id:"titlechange",onChange:this.handleTitleChange,value:this.state.tempListTitle,type:"text"}),React.createElement("input",{className:"btn btn-sm btn-dark",type:"submit",value:"Change"}),React.createElement("button",{className:"btn btn-sm btn-dark",onClick:this.showTitleEditor},"X")))}}]),e}(),BoardTitleComponent=function(t){function e(t){_classCallCheck(this,e);var s=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return s.state={boardtitle:s.props.title,tempboardtitle:s.props.title,showboardtitleeditor:!1},s.clickOutsideTarget=s.clickOutsideTarget.bind(s),s.changeBoardTitle=s.changeBoardTitle.bind(s),s.showBoardTitleEditor=s.showBoardTitleEditor.bind(s),s}return _inherits(e,React.Component),_createClass(e,[{key:"clickOutsideTarget",value:function(){var t=this;window.addEventListener("click",function(e){!e.target.matches(".boardtitle")&&t.state.showboardtitleeditor&&(t.setState({showboardtitleeditor:!1}),""!==t.state.tempboardtitle.trim()?(temps.changeTitle(t.state.tempboardtitle),t.setState({boardtitle:temps.getTitle(),tempboardtitle:temps.getTitle()})):t.setState({tempboardtitle:t.state.boardtitle}))})}},{key:"changeBoardTitle",value:function(){this.setState({tempboardtitle:event.target.value})}},{key:"showBoardTitleEditor",value:function(){this.setState({showboardtitleeditor:!0}),window.setTimeout(function(){return document.getElementById("boardtitleeditor").select()},0)}},{key:"render",value:function(){return this.clickOutsideTarget(),React.createElement("div",null,React.createElement("p",{className:"whitetext "+(this.state.showboardtitleeditor?"hiddentextarea":"")},React.createElement("b",{onClick:this.showBoardTitleEditor,className:"actlikebutton padding5px boardtitle"},this.state.boardtitle)),React.createElement("p",{className:"whitetext "+(this.state.showboardtitleeditor?"":"hiddentextarea")},React.createElement("input",{id:"boardtitleeditor",className:"boardtitle",type:"text",onChange:this.changeBoardTitle,value:this.state.tempboardtitle})))}}]),e}(),CardsComponent=function(t){function e(t){_classCallCheck(this,e);var s=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));s.state={cards:temps.getById(s.props.id).cards,showActionList:[],showAddCardList:!1,cardTitle:""},s.toggleAddCardList=s.toggleAddCardList.bind(s),s.addCard=s.addCard.bind(s),s.handleCardTitleChange=s.handleCardTitleChange.bind(s),s.copyCards=[],s.deleteCards=[],s.showCardActions=[];for(var i=s.state.cards.length,a=0;a<i;a++)s.copyCards.push(s.copyCard.bind(s,a)),s.deleteCards.push(s.deleteCard.bind(s,a)),s.showCardActions.push(s.showCardAction.bind(s,a));return s}return _inherits(e,React.Component),_createClass(e,[{key:"toggleAddCardList",value:function(){this.setState({showAddCardList:!this.state.showAddCardList})}},{key:"handleCardTitleChange",value:function(){this.setState({cardTitle:event.target.value})}},{key:"showCardAction",value:function(t){var e=[].concat(_toConsumableArray(this.state.showActionList));e[t]?e[t]=!e[t]:(e=[])[t]=!e[t],this.setState({showActionList:e})}},{key:"addCard",value:function(){event.preventDefault(),temps.getById(this.props.id).cards.push({id:"C"+temps.get().ids.cardsId,title:this.state.cardTitle}),temps.addCardId(),this.setState({cards:temps.getById(this.props.id).cards,cardTitle:""});var t=this.state.cards.length;this.copyCards.push(this.copyCard.bind(this,t-1)),this.deleteCards.push(this.deleteCard.bind(this,t-1)),this.showCardActions.push(this.showCardAction.bind(this,t-1))}},{key:"deleteCard",value:function(t){temps.getById(this.props.id).cards.splice(t,1),this.setState({cards:temps.getById(this.props.id).cards,showActionList:[]})}},{key:"copyCard",value:function(t){var e={id:"C"+temps.get().ids.cardsId,title:temps.getById(this.props.id).cards[t].title+"(1)"};temps.getById(this.props.id).cards.push(e),temps.addCardId(),this.setState({cards:temps.getById(this.props.id).cards,showActionList:[]});var s=this.state.cards.length;this.copyCards.push(this.copyCard.bind(this,s-1)),this.deleteCards.push(this.deleteCard.bind(this,s-1)),this.showCardActions.push(this.showCardAction.bind(this,s-1))}},{key:"render",value:function(){var t=this,e=this.state.cards.map(function(e,s){return void 0===t.showCardActions[s]&&(t.showCardActions.push(t.showCardAction.bind(t,s)),t.copyCards.push(t.copyCard.bind(t,s)),t.deleteCards.push(t.deleteCard.bind(t,s))),React.createElement(ReactBeautifulDnd.Draggable,{key:e.id,draggableId:e.id,index:s},function(i){return React.createElement("div",Object.assign({},i.draggableProps,i.dragHandleProps,{ref:i.innerRef}),React.createElement("li",null,React.createElement("div",{className:"white cardtitle"},React.createElement("p",{className:"fixwidth"},e.title+" ("+e.id+")"),React.createElement("div",null,React.createElement("button",{className:"btn btn-sm actionbutton",onClick:t.showCardActions[s]},"..."),React.createElement("div",{className:"inner"},React.createElement("div",{className:"inline actionlist "+(t.state.showActionList[s]?"":"hiddentextarea")},React.createElement("button",{className:"btn actionbutton",onClick:t.deleteCards[s]},"Delete"),React.createElement("br",null),React.createElement("button",{className:"btn actionbutton",onClick:t.copyCards[s]},"Copy")))))))})});return React.createElement("div",null,React.createElement(ReactBeautifulDnd.Droppable,{key:this.props.id,droppableId:this.props.id,type:"task"},function(t){return React.createElement("div",Object.assign({className:"Container"},t.droppableProps,{ref:t.innerRef}),React.createElement("div",null,React.createElement("ul",null,e)),t.placeholder)}),React.createElement("button",{className:"btn btn-sm btn-link "+(this.state.showAddCardList?"hiddentextarea":""),type:"button",onClick:this.toggleAddCardList},"Add another card"),React.createElement("div",{className:this.state.showAddCardList?"":"hiddentextarea "},React.createElement("textarea",{className:"w-100",placeholder:"Enter a title for this card...",onChange:this.handleCardTitleChange,value:this.state.cardTitle}),React.createElement("div",{className:"inlinetable just"},React.createElement("button",{className:"btn btn-sm btn-success",onClick:this.addCard},"Add card"),React.createElement("button",{className:"btn btn-sm btn-dark",onClick:this.toggleAddCardList},"x"),React.createElement("button",{className:"btn btn-sm btn-dark"},"..."))))}}]),e}(),BoardComponent=function(t){function e(t){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return _inherits(e,React.Component),_createClass(e,[{key:"render",value:function(){return React.createElement("div",{className:"h-100"},React.createElement(BoardTitleComponent,{title:temps.getTitle()}),React.createElement("div",{className:"inlinetable"},React.createElement(ListsComponent,null)))}}]),e}();ReactDOM.render(React.createElement(BoardComponent,null),document.getElementById("board"));
